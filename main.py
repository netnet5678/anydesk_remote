from tkinter import *
from tkinter import messagebox
import subprocess

def chack_IP():
    # Mapping store codes to Anydesk IDs
    store_to_anydesk = {
        '70001': '1768356964',
        '70002': '758685156',
        '70003': '1770683204',
        '70005': '783479185',
        '70007': '1377344532',
        '70008': '1919043068',
        '70009': '1139435407',
        '70010': '1642525227',
        '70011': '1265321469',
        '70012': '1696153125',
        '70013': '774807382',
        '70014': '1718893110',
        '70015': '1326522953',
        '70016': '675657964',
        '70017': '1358150656',
        '70018': '266989622',
        '70020': '906228251',
        '70021': '1861076655',
        '70022': '1717678986',
        '70023': '1107394713',
        '70024': '1592342037',
        '70025': '1221203974',
        '70026': '1246411696',
        '70027': '1221293631',
        '70028': '1886099765',
        '70029': '1927484518',
        '70030': '1350576238',
        '70031': '323620717',
        '70032': '1911840288',
        '70034': '1531767432',
        '70035': '1642808091',
        '70036': '1330296560',
        '70037': '1513799146',
        '70038': '1697192797',
        '70039': '1134231665',
        '70040': '1302507953',
        '70041': '1620083216',
        '70042': '1257302063',
        '70043': '1349065502',
        '70044': '576676397',
        '70046': '364658778',
        '70047': '1809059796',
        '70050': '1251209784',
        '70051': '1207076282',
        '70053': '1278896001',
        '70054': '1750621705',
        '70055': '1707098096',
        '70056': '1735973663',
        '70057': '1816838909',
        '70058': '1383465814',
        '70059': '169024398',
        '70060': '873548604',
        '70061': '1842012866',
        '70062': '1467896086',
        '70063': '327123337',
        '70065': '1428861172',
        '70066': '1749108505',
        '70067': '1457123622',
        '70068': '390923254',
        '70069': '1212367379',
        '70070': '550792911',
        '70071': '1104931177',
        '70072': '1298277493',
        '70073': '1590953077',
        '70074': '1433781215',
        '70075': '1041919412',
        '70076': '1089021908',
        '70077': '569869364',
        '70078': '1748005502',
        '70079': '1684586619',
        '70080': '1352791107',
        '70082': '483380269',
        '70083': '1958916052',
        '70084': '1062389567',
        '70086': '1839065637',
        '70087': '1631653697',
        '70088': '469245498',
        '70089': '1428519958',
        '70090': '1721487937',
        '70091': '875497895',
        '70092': '1408996376',
        '70093': '1223851093',
        '70094': '1219100612',
        '70095': '1108019502',
        '70096': '1859530834',
        '70097': '1809447508',
        '70098': '414323126',
        '70099': '1952899196',
        '70100': '1464627412',
        '70101': '1564290692',
        '70103': '1648398736',
        '70104': '1519688662',
        '70105': '1398043800',
        '70106': '1968371462',
        '70107': '1038866195',
        '70108': '1467554207',
        '70109': '1376218504',
        '70110': '1634044887',
        '70111': '1768527288',
        '70112': '1931530413',
        '70113': '1484894110',
        '70114': '1157502382',
        '70115': '1755316557',
        '70116': '1362377810',
        '70117': '1909006488',
        '70118': '1643574566',
        '70119': '1468496909',
        '70120': '1863173933',
        '70121': '1046864504',
        '70122': '1874656005',
        '70123': '1529175374',
        '70124': '1191450017',
        '70125': '1067860298',
        '70126': '525848918',
        '70128': '1202759715',
        '70131': '622748560',
        '70132': '252858901',
        '70135': '1215613910',
        '70136': '644812619',
        '70137': '1805123648',
        '70138': '1565517044',
        '70139': '1907961012',
        '70140': '1126515559',
        '70142': '981308556',
        'ipad': '1724243176',
        '70007 2': '1562453259',
        '70010 2': '1247536793',
        '70021 2': '1461563265',
        '70023 2': '1302694499',
        '70024 2': '1353979043',
        '70027 2': '1467637323',
        '70035 2': '1633907724',
        '70039 2': '1452731555',
        '70047 2': '1307571738',
        '70050 2': '1013490240',
        '70056 2': '169024398',
        '70110 2': '1686126804',
        '70112 2': '1782417903',
        '70113 2': '1489926493',
        '70116 2': '1525117487',
        '70119 2': '1141034542',
        '70120 2': '1390376833',
        '70123 2': '1452510602',
        '60001': '841659222',
        '60001 2': '514948811',
        '60002': '620324109',
        '60002 2': '854739151',
        '60003': '1742644480',
        '60003 2': '181305196',
        '60004': '376297074',
        '60005': '1580946895',
        '60005 2': '1863116511',
        '60006': '1701385330',
        '60006 2': '705269412',
        '60008': '683129936',
        '60008 2': '223751773',
        '60009': '1933313356',
        '60011': '122463250',
        '60011 2': '1108131978',
        '60012': '351883667',
        '60013': '1810275724',
        '60014': '1003249763',
        '60014 2': '779323354',
    }
    store = text.get()
    # ตรวจสอบว่ารหัสสาขาที่ใส่เข้ามาถูกต้องหรือไม่
    if not store:
        messagebox.showwarning("ข้อผิดพลาด", "กรุณาใส่รหัสสาขา")
        return

    anydesk_id = store_to_anydesk.get(store)

    # ตรวจสอบว่าพบรหัสหรือไม่
    if anydesk_id:
        with open("anydesk_result.txt", "w") as file:
            file.write(f"{anydesk_id}\n")
        # แจ้งเตือนว่าการทำงานเสร็จเรียบร้อย
        messagebox.showinfo("สำเร็จ", f"พบรหัส Anydesk: {anydesk_id}")
        btn2.config(state='normal')
    else:
        # แจ้งเตือนว่ารหัสสาขาไม่ถูกต้อง
        messagebox.showerror("ข้อผิดพลาด", "ไม่พบรหัสสาขาที่คุณกรอก")
def run_program():
    # เปลี่ยน 'C:/Path/To/Your/Program.exe' เป็น path ของโปรแกรมที่ต้องการเรียก
    program_path = 'Script.exe'
    subprocess.run([program_path])
    
# ฟังก์ชันเพื่อทำให้หน้าต่างอยู่กลางหน้าจอ
def center_window(win, width, height):
    screen_width = win.winfo_screenwidth()
    screen_height = win.winfo_screenheight()

    x = (screen_width // 2) - (width // 2)
    y = (screen_height // 2) - (height // 2)

    win.geometry(f'{width}x{height}+{x}+{y}')

# สร้างหน้าต่างหลัก
root = Tk()
root.title("Store Anydesk")

# ขนาดหน้าต่าง
window_width = 400
window_height = 200
center_window(root, window_width, window_height)  # เรียกฟังก์ชันเพื่อจัดตำแหน่งหน้าต่างให้อยู่กลางจอ

# จัด layout ด้วยการใช้ grid และ padding
root.columnconfigure(0, weight=1)
root.columnconfigure(1, weight=1)

# ใส่ข้อความ
myLabel1 = Label(root, text='รหัสสาขา', font=('Arial', 14))
myLabel1.grid(row=0, column=0, columnspan=2, pady=10)

# กล่องข้อความ
text = StringVar()
input_data = Entry(root, textvariable=text, font=('Arial', 12), width=20)
input_data.grid(row=1, column=0, columnspan=2, pady=5)

# ใส่ปุ่ม
btn1 = Button(root, text='ค้นหา', font=('Arial', 12), command=chack_IP, width=10)
btn1.grid(row=2, column=0, padx=10, pady=10)

btn2 = Button(root, text='เชื่อมต่อ', font=('Arial', 12), state='disabled', command=run_program, width=10)
btn2.grid(row=2, column=1, padx=10, pady=10)

# เริ่มต้น GUI
root.mainloop()
